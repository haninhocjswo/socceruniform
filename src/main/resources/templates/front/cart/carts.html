<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/front/fragment/frontHeader.html :: frontHeader}">
</head>
<body>
<!-- Navigation-->
<nav th:replace="~{/front/fragment/frontNav.html :: frontNav}">
</nav>
<!-- Product section-->
<section class="py-5">
    <div class="container px-4 px-lg-5 my-5">
        <div class="row gx-4 gx-lg-5 align-items-center">
            <div class="col-md-12">
                <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center"
                        th:each="cart : ${carts}">
                        <div class="col-md-1" style="text-align:center;"><input type="checkbox" th:value="${cart.cartId}" style="width:20px;height:20px;" /></div>
                        <div class="col-md-1"><img class="card-img-top mb-5 mb-md-0" src="https://dummyimage.com/600x700/dee2e6/6c757d.jpg" alt="..." /></div>
                        <div class="col-md-3" th:text="${cart.description}">description</div>
                        <div class="col-md-2">
                            <button class="btn btn-primary" type="button" th:onclick="minusStock([[cart.cartId]]);">-</button>
                            <input type="number" class="text-center stock" th:id="'cart-stock-' + ${cart.cartId}" th:value="${cart.stock}" />
                            <button class="btn btn-primary" type="button" th:onclick="plusStock([[${cart.cartId}]]);">+</button>
                        </div>
                        <div class="col-md-2"><span th:text="${#numbers.formatInteger(cart.price, 3, 'COMMA') + ' 원'}" style="font-size:30px;"></span></div>
                        <button class="btn-lg btn-warning edit-cart" th:onclick="editCart([[${cart.cartId}]]);">수정</button>
                        <button class="btn-lg btn-danger delete-cart" th:onclick="delCart([[${cart.cartId}]]);">X</button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="../../js/front/scripts.js"></script>
<script th:inline="javascript">
function editCart(cartId) {
    let selectedId = 'cart-stock-' + cartId;
    let cartStockId = $('#' + selectedId).val();

    $.ajax({
        url: '/cart/edit',
        type: 'POST',
        data: {'cartId': cartId, 'stock': cartStockId},
        dataType: 'json',
        success: function(data) {
            let result = data['result'];
            if(!result) {
                alert(data['message']);
            }
        },
        error: function(data) {
        }
    });
}

function delCart(cartId) {
    $.ajax({
        url: '/cart/delete',
        type: 'POST',
        data: {'cartId': cartId},
        dataType: 'json',
        success: function(data) {
            let result = data['result'];
            if(!result) {
                alert(data['message']);
            }
        },
        error: function(data) {
        }
    });
}

function plusStock(cartId) {

}

function minusStock(cartId) {

}
</script>
</body>
<!-- Footer-->
<footer th:replace="~{/front/fragment/frontFooter.html :: frontFooter}">
</footer>
</html>
